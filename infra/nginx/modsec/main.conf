# ModSecurity Main Configuration
# Included by nginx.conf

# Basic configuration
SecRuleEngine On
SecRequestBodyAccess On
SecResponseBodyAccess Off

# Upload handling
SecUploadDir /tmp
SecUploadKeepFiles Off

# Debug log
SecDebugLog /var/log/modsec_debug.log
SecDebugLogLevel 0

# Serial logging (stdout)
SecAuditEngine RelevantOnly
SecAuditLogParts ABIJDEFHZ
SecAuditLog /dev/stdout

# CRS setup (if using the owasp image, this might be handled by their env vars,
# but explicit include is safer if we want custom control)
# Include /opt/owasp-crs/crs-setup.conf
# Include /opt/owasp-crs/rules/*.conf
